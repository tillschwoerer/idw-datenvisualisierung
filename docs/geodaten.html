<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Geodaten | Einführung in die Datenvisualisierung mit R</title>
  <meta name="description" content="3 Geodaten | Einführung in die Datenvisualisierung mit R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Geodaten | Einführung in die Datenvisualisierung mit R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="tillschwoerer/idw-datenvisualisierung" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Geodaten | Einführung in die Datenvisualisierung mit R" />
  
  
  

<meta name="author" content="Tillmann Schwörer" />


<meta name="date" content="2021-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ggplot2.html"/>
<link rel="next" href="aggregierte-daten.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Einführung</a></li>
<li class="chapter" data-level="2" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ggplot2.html"><a href="ggplot2.html#grundlagen"><i class="fa fa-check"></i><b>2.1</b> Grundlagen</a></li>
<li class="chapter" data-level="2.2" data-path="ggplot2.html"><a href="ggplot2.html#ästhetik-zuordnung"><i class="fa fa-check"></i><b>2.2</b> Ästhetik-Zuordnung</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ggplot2.html"><a href="ggplot2.html#kardinal-skalierte-variable"><i class="fa fa-check"></i><b>2.2.1</b> Kardinal-skalierte Variable</a></li>
<li class="chapter" data-level="2.2.2" data-path="ggplot2.html"><a href="ggplot2.html#nominal-skalierte-variable"><i class="fa fa-check"></i><b>2.2.2</b> Nominal-skalierte Variable</a></li>
<li class="chapter" data-level="2.2.3" data-path="ggplot2.html"><a href="ggplot2.html#fixierte-ästhetik"><i class="fa fa-check"></i><b>2.2.3</b> Fixierte Ästhetik</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ggplot2.html"><a href="ggplot2.html#geometrisches-objekt"><i class="fa fa-check"></i><b>2.3</b> Geometrisches Objekt</a></li>
<li class="chapter" data-level="2.4" data-path="ggplot2.html"><a href="ggplot2.html#skalierung"><i class="fa fa-check"></i><b>2.4</b> Skalierung</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ggplot2.html"><a href="ggplot2.html#axen-skalierung"><i class="fa fa-check"></i><b>2.4.1</b> Axen-Skalierung:</a></li>
<li class="chapter" data-level="2.4.2" data-path="ggplot2.html"><a href="ggplot2.html#farb-skalierung"><i class="fa fa-check"></i><b>2.4.2</b> Farb-Skalierung</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ggplot2.html"><a href="ggplot2.html#facetten"><i class="fa fa-check"></i><b>2.5</b> Facetten</a></li>
<li class="chapter" data-level="2.6" data-path="ggplot2.html"><a href="ggplot2.html#thema-und-labels"><i class="fa fa-check"></i><b>2.6</b> Thema und Labels</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ggplot2.html"><a href="ggplot2.html#labels"><i class="fa fa-check"></i><b>2.6.1</b> Labels</a></li>
<li class="chapter" data-level="2.6.2" data-path="ggplot2.html"><a href="ggplot2.html#thema"><i class="fa fa-check"></i><b>2.6.2</b> Thema</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geodaten.html"><a href="geodaten.html"><i class="fa fa-check"></i><b>3</b> Geodaten</a>
<ul>
<li class="chapter" data-level="3.1" data-path="geodaten.html"><a href="geodaten.html#simple-features"><i class="fa fa-check"></i><b>3.1</b> Simple Features</a></li>
<li class="chapter" data-level="3.2" data-path="geodaten.html"><a href="geodaten.html#ästhetiken"><i class="fa fa-check"></i><b>3.2</b> Ästhetiken</a></li>
<li class="chapter" data-level="3.3" data-path="geodaten.html"><a href="geodaten.html#schichten"><i class="fa fa-check"></i><b>3.3</b> Schichten</a></li>
<li class="chapter" data-level="3.4" data-path="geodaten.html"><a href="geodaten.html#aggregation"><i class="fa fa-check"></i><b>3.4</b> Aggregation</a></li>
<li class="chapter" data-level="3.5" data-path="geodaten.html"><a href="geodaten.html#koordinatensystem"><i class="fa fa-check"></i><b>3.5</b> Koordinatensystem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aggregierte-daten.html"><a href="aggregierte-daten.html"><i class="fa fa-check"></i><b>4</b> Aggregierte Daten</a>
<ul>
<li class="chapter" data-level="4.1" data-path="aggregierte-daten.html"><a href="aggregierte-daten.html#sortierung"><i class="fa fa-check"></i><b>4.1</b> Sortierung</a></li>
<li class="chapter" data-level="4.2" data-path="aggregierte-daten.html"><a href="aggregierte-daten.html#überlappungen"><i class="fa fa-check"></i><b>4.2</b> Überlappungen</a></li>
<li class="chapter" data-level="4.3" data-path="aggregierte-daten.html"><a href="aggregierte-daten.html#zwei-kategoriale-variablen"><i class="fa fa-check"></i><b>4.3</b> Zwei kategoriale Variablen</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="zeit.html"><a href="zeit.html"><i class="fa fa-check"></i><b>5</b> Zeit</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Einführung in die Datenvisualisierung mit R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geodaten" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Geodaten</h1>
<p>Visualisierung von Geodaten</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="geodaten.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)   </span>
<span id="cb40-2"><a href="geodaten.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)          </span>
<span id="cb40-3"><a href="geodaten.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb40-4"><a href="geodaten.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb40-5"><a href="geodaten.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb40-6"><a href="geodaten.html#cb40-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-7"><a href="geodaten.html#cb40-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">legend.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb40-8"><a href="geodaten.html#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="simple-features" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Simple Features</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="geodaten.html#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;data/wdi.rds&quot;</span>)        <span class="co"># Einlesen der Daten</span></span>
<span id="cb41-2"><a href="geodaten.html#cb41-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(jahr<span class="sc">==</span><span class="dv">2018</span>)       <span class="co"># Einschränkung auf das aktuellste Jahr im Datensatz</span></span>
<span id="cb41-3"><a href="geodaten.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 23 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -61.88711 ymin: 16.99717 xmax: 74.89131 ymax: 42.64795
## CRS:            +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## # A tibble: 6 x 24
##   iso2c land         kontinent   subregion    jahr bevölkerung bevölkerung_weib~
##   &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       &lt;int&gt;       &lt;dbl&gt;             &lt;dbl&gt;
## 1 AD    Andorra      Europe      Southern E~  2018       77006              NA  
## 2 AE    United Arab~ Asia        Western As~  2018     9630959              30.6
## 3 AF    Afghanistan  Asia        Southern A~  2018    37172386              48.6
## 4 AG    Antigua and~ North Amer~ Caribbean    2018       96286              51.8
## 5 AL    Albania      Europe      Southern E~  2018     2866376              49.1
## 6 AM    Armenia      Asia        Western As~  2018     2951776              53.0
## # ... with 17 more variables: bevölkerung_0_14 &lt;dbl&gt;, bevölkerung_65+ &lt;dbl&gt;,
## #   bevölkerung_land &lt;dbl&gt;, bevölkerung_stadt &lt;dbl&gt;,
## #   bevölkerung_unter$5.50 &lt;dbl&gt;, bruttosozialprodukt &lt;dbl&gt;, fläche &lt;dbl&gt;,
## #   lebenserwartung &lt;dbl&gt;, lebenserwartung_mann &lt;dbl&gt;,
## #   lebenserwartung_frau &lt;dbl&gt;, kindersterblichkeit &lt;dbl&gt;, geburtenrate &lt;dbl&gt;,
## #   co2_emissionen &lt;dbl&gt;, literacy_rate &lt;dbl&gt;, militärausgaben &lt;dbl&gt;,
## #   mordrate &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [°]&gt;</code></pre>
<p>Es handelt sich nicht um einen gewöhnlichen R Datensatz (data frame), sondern um einen sogenannten <strong>Simple Feature</strong> Datensatz. Das besondere daran ist die Variable <code>geometry</code>, welche die Koordinaten (Längengrad und Breitengrad) der Ländergrenzen enthält.</p>
<p>Analog zum bisherigen Vorgehen, benötigen wir für die Visualisierung einer Weltkarte nur 3 Dinge: (1) den (Simple Feature) Datensatz, (2) eine Ästhetikzuordnung (die Variable <code>geometry</code> wird der Ästhetik <strong>geometry</strong> zugeordet, und (3) den passenden Objecttyp <code>geom_sf</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="geodaten.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">geometry =</span> geometry)) <span class="sc">+</span> <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Tatsächlich können wir hier die Ästhetikzuordnung sogar weglassen, die Spezifikation des Datensatzes und <code>geom_sf</code> ist hier sogar ausreichend.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="geodaten.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><strong>Was bedeutet der Begriff feature?</strong> Ein Feature kann grundsätzlich alles mögliche sein (Land, Fluss, Bushaltestelle), in unserem Fall ist es ein Land. Features können durch unterschiedliche Geometrien repräsentiert werden: eine Bushaltestelle durch einen <strong>Punkt</strong>, ein Fluss durch eine <strong>Linie</strong>, ein Land durch ein <strong>Polygon</strong> oder <strong>Multipolygon</strong>. Beispielsweise kann das “Vereinigte Königreich” nur durch einen Multipolygon repräsentiert werden, da es aus zwei Inseln (jeweils Polygone) besteht.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="geodaten.html#cb45-1" aria-hidden="true" tabindex="-1"></a>uk <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(land <span class="sc">==</span> <span class="st">&quot;United Kingdom&quot;</span>)</span>
<span id="cb45-2"><a href="geodaten.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(uk) <span class="sc">+</span> <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="geodaten.html#cb46-1" aria-hidden="true" tabindex="-1"></a>uk[[<span class="st">&quot;geometry&quot;</span>]][[<span class="dv">1</span>]][[<span class="dv">1</span>]]        <span class="co"># Dies sind die Koordinaten von Irland</span></span></code></pre></div>
<pre><code>## [[1]]
##            [,1]     [,2]
##  [1,] -1.065576 50.69023
##  [2,] -1.149365 50.65571
##  [3,] -1.175830 50.61523
##  [4,] -1.196094 50.59922
##  [5,] -1.251465 50.58882
##  [6,] -1.306299 50.58853
##  [7,] -1.515332 50.66978
##  [8,] -1.563428 50.66611
##  [9,] -1.515674 50.70332
## [10,] -1.385840 50.73354
## [11,] -1.312793 50.77349
## [12,] -1.144238 50.73472
## [13,] -1.065576 50.69023</code></pre>
</div>
<div id="ästhetiken" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Ästhetiken</h2>
<p>Die wichtigste Ästhetik ist bei Karten in der Regel die Füllfarbe (<code>fill</code>). Wie bisher können sie sie entweder die Füllfarbe entweder auf eine bestimmte Ausprägung (bspw. “red”) fixieren, oder eine Variable des Datensatzes der Füllfarbe zuordnen (<em>aesthetic mapping</em>). Zu beachten: Die Farbe der Landesgrenzen können über <code>color</code> Ästhetik beeinflusst werden.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="geodaten.html#cb48-1" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>()                   </span>
<span id="cb48-2"><a href="geodaten.html#cb48-2" aria-hidden="true" tabindex="-1"></a>map <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span>kontinent))                    <span class="co"># nominal-skalierte Variable</span></span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="geodaten.html#cb49-1" aria-hidden="true" tabindex="-1"></a>map <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span>lebenserwartung))              <span class="co"># kardinal-skalierte Variable</span></span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="geodaten.html#cb50-1" aria-hidden="true" tabindex="-1"></a>map <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span>lebenserwartung), <span class="at">color =</span> <span class="cn">NA</span>)  <span class="co"># fest definierte Länderfarbe (hier unsichtbar)</span></span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
</div>
<div id="schichten" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Schichten</h2>
<p>Wie bisher können Sie auch hier über zusätzliche <code>geom_[typ]</code> Funktionen weitere Schichten definieren. Dies ist auch hier insbesondere für Hervorhebungen hilfreich.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="geodaten.html#cb51-1" aria-hidden="true" tabindex="-1"></a>auswahl <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(land <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;China&quot;</span>, <span class="st">&quot;South Africa&quot;</span>)) </span>
<span id="cb51-2"><a href="geodaten.html#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="geodaten.html#cb51-3" aria-hidden="true" tabindex="-1"></a>map <span class="sc">+</span> </span>
<span id="cb51-4"><a href="geodaten.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span>kontinent)) <span class="sc">+</span></span>
<span id="cb51-5"><a href="geodaten.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_label</span>(<span class="at">data =</span> auswahl, <span class="fu">aes</span>(<span class="at">label=</span>land)) </span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="aggregation" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Aggregation</h2>
<p>In manchen Situationen möchten wir die Daten durch eine Aggregation verdichten, bspw. um die durchschnittliche Lebenserwartung je Kontinent zu berechnen.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="geodaten.html#cb52-1" aria-hidden="true" tabindex="-1"></a>kontinente <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="geodaten.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(kontinent) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="geodaten.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lebenserwartung =</span> <span class="fu">mean</span>(lebenserwartung, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) </span>
<span id="cb52-4"><a href="geodaten.html#cb52-4" aria-hidden="true" tabindex="-1"></a>kontinente</span></code></pre></div>
<pre><code>## Simple feature collection with 7 features and 2 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -180 ymin: -55.8917 xmax: 180 ymax: 83.59961
## CRS:            +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## # A tibble: 7 x 3
##   kontinent       lebenserwartung                                       geometry
##   &lt;chr&gt;                     &lt;dbl&gt;                             &lt;MULTIPOLYGON [°]&gt;
## 1 Africa                     63.4 (((-2.938306 5.124495, -2.94834 5.118848, -3.~
## 2 Asia                       74.3 (((122.9489 -10.90928, 122.8559 -10.90967, 12~
## 3 Europe                     79.3 (((55.79736 -21.33936, 55.65615 -21.36904, 55~
## 4 North America              76.0 (((-78.89834 8.274268, -78.91812 8.231934, -7~
## 5 Oceania                    73.4 (((158.8788 -54.70977, 158.8452 -54.74922, 15~
## 6 Seven seas (op~            75.3 (((57.65127 -20.48486, 57.5248 -20.51318, 57.~
## 7 South America              74.9 (((-67.5752 -55.88965, -67.61143 -55.8917, -6~</code></pre>
<p>Die gute Nachricht: bei der Aggregation wird auch die <code>geometry</code> Variable so aktualisiert, dass diese nun die Umrisse der jeweiligen Kontinente repräsentiert.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="geodaten.html#cb54-1" aria-hidden="true" tabindex="-1"></a>kontinente <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> lebenserwartung), <span class="at">color =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="koordinatensystem" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Koordinatensystem</h2>
<p>Bisher haben wir das Thema <strong>Koordinatensystem</strong> nicht explizit angesprochen. Im Kontext von Karten ist es aber besonders relevant, da unsere 3-dimensionale Erde nicht akurat in 2 Dimensionen dargestellt werden kann. Es stehen uns nun unterschiedlich Projektionen zu Verfügung, die jeweils vorgeben, wo die Längen- und Breitengrade in den zwei Dimensionn verortet werden.</p>
<p>Betrachten wir nun folgende Basiskarte:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="geodaten.html#cb55-1" aria-hidden="true" tabindex="-1"></a>(basiskarte <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="geodaten.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-3"><a href="geodaten.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> kontinent), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="geodaten.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>))</span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Die <strong>Mercator Projection</strong> stellt Formen und Winkel korrekt dar, aber in Richtung der Pole wird die Größe der Länder künstlich aufgebläht.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="geodaten.html#cb56-1" aria-hidden="true" tabindex="-1"></a>basiskarte <span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="st">&quot;+proj=merc&quot;</span>)) </span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Hingegen werden bei der <strong>Lambert Azimuthal Equal Area</strong> (LAEA) Projektion die Ländergrößen korrekt dargestellt, wobei aber eine Verzerrung der Formen und Winkel in Kauf genommen wird. Auch der Perspektivwechsel auf einen anderen Mittelpunkt (hier Lhasa, Tibet) kann einen Mehrwert bzgl. der Interpretation schaffen.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="geodaten.html#cb57-1" aria-hidden="true" tabindex="-1"></a>basiskarte <span class="sc">+</span> <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="st">&quot;+proj=laea + lat_0=29.6490404 + lon_0=91.0052352&quot;</span>))</span></code></pre></div>
<p><img src="02-geodaten_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aggregierte-daten.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"df_print": "paged"
});
});
</script>

</body>

</html>
