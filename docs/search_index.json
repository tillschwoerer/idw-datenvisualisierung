[["index.html", "Einführung in die Datenvisualisierung mit R 1 Einführung", " Einführung in die Datenvisualisierung mit R Tillmann Schwörer 2021-05-03 1 Einführung "],["ggplot2.html", "2 ggplot2 2.1 Grundlagen 2.2 Ästhetik-Zuordnung 2.3 Geometrisches Objekt 2.4 Skalierung 2.5 Facetten 2.6 Thema und Labels", " 2 ggplot2 library(tidyverse) theme_set(theme_bw()) # Standard Thema (Hintergrund, etc.) für die Grafiken df &lt;- read_csv(&quot;data/gebrauchtwagen.csv&quot;) # Daten einlesen sample &lt;- df %&gt;% slice(1:500) # Kleiner Datensatz, der die ersten 500 Zeilen umfasst head(sample) ## # A tibble: 6 x 13 ## name preis alter kilometer hersteller modell fahrzeugtyp getriebe ps ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 smart_forT~ 5299 7 30000 smart fortwo kleinwagen automat~ 71 ## 2 Renault_Cl~ 1100 16 125000 renault clio kleinwagen manuell 75 ## 3 Audi_A4_Av~ 8199 14 150000 audi a4 kombi automat~ 131 ## 4 Mercedes_B~ 8999 8 150000 mercedes_~ c_kla~ limousine automat~ 136 ## 5 BMW_316_i_~ 3600 13 150000 bmw 3er limousine manuell 116 ## 6 verk._eine~ 2490 11 150000 peugeot 1_rei~ kleinwagen manuell 68 ## # ... with 4 more variables: kraftstoff &lt;chr&gt;, schaden &lt;chr&gt;, plz &lt;dbl&gt;, ## # bundesland &lt;chr&gt; 2.1 Grundlagen Minimale Angaben zur Erstellung einer Grafik: Datensatz (data) Ästhetik-Zuordnung (aesthetic mapping): Welche Variable des Datensatzes wird durch welche Ästhetik (x-Achse, y-Achse, Farbe, Größe, Form, ) repräsentiert? Geometrisches Objekt (geometric object): z.B. Punkte, Linien, Balken, etc. ggplot(data = sample, mapping = aes(x = alter, y = preis)) + geom_point() Wie ändert sich die Grafik, wenn wir den vollen Datensatz (df) verwenden? ggplot(data = df, mapping = aes(x = alter, y = preis)) + geom_point() Wie ändert sich die Grafik, wenn wir eine andere Variablenzuordnung vornehmen? ggplot(data = sample, mapping = aes(x = preis, y = alter)) + geom_point() ggplot(data = sample, mapping = aes(x = preis, y = hersteller)) + geom_point() ggplot(data = sample, mapping = aes(x = fahrzeugtyp, y = hersteller)) + geom_point() Wie ändert sich die Grafik, wenn wir einen anderen Objekttyp wählen? ggplot(data = sample, mapping = aes(x = fahrzeugtyp, y = hersteller)) + geom_jitter(width = 0.1) ggplot(data = df, mapping = aes(x = alter, y = preis)) + geom_density2d_filled() 2.2 Ästhetik-Zuordnung Über weitere Ästhetik-Zuordnungen (Welche Variable wird durch welche Ästhetik repräsentiert?) können wir eine mehrdimensionale Visualisierung erstellen. Welche Ästhetiken für geom_point zur Verfügung stehen, kann man via help(geom_point) unter der Überschrift Aesthetics nachlesen. 2.2.1 Kardinal-skalierte Variable Für kardinal-sklaierte Variablen ist bspw. die Form-Ästhetik (shape) ungeeignet sample %&gt;% ggplot(mapping = aes(x = alter, y = preis, color = ps)) + geom_point() sample %&gt;% ggplot(mapping = aes(x = alter, y = preis, size = ps)) + geom_point() sample %&gt;% ggplot(mapping = aes(x = alter, y = preis, alpha = ps)) + geom_point() 2.2.2 Nominal-skalierte Variable Für nominal-skalierte Variablen sind Größe (size) und Transparenz (alpha) wenig geeignet sample %&gt;% ggplot(mapping = aes(x = alter, y = preis, color = fahrzeugtyp)) + geom_point() sample %&gt;% ggplot(mapping = aes(x = alter, y = preis, shape = fahrzeugtyp)) + geom_point() 2.2.3 Fixierte Ästhetik Beachten Sie den Unterschied zwischen (1) einer Zuordnung (aesthetic mapping) und (2) einer fest definierten Ästhetik! Im folgenden Beispiel werden die Ästhetiken Farbe (color), Transparenz (alpha), Größe (size) und Form (shape) auf konkrete Werte festgelegt. Das heißt für jeden dargestellten Datenpunkt wird dieselbe Farbe, Transparenz, etc. verwendet. Hingegen bekommen bei einer Ästhetik-Zuordnung die Datenpunkte unterschiedliche Farben, Transparenzen, etc. in Abhängigkeit vom Wert der jeweiligen Variable des Datensatzes. sample %&gt;% ggplot(mapping = aes(x = alter, y = preis)) + geom_point(color = &quot;#54b856&quot;, alpha = 0.5, size = 3, shape = 18) 2.3 Geometrisches Objekt Grundsätzlich stehen Ihnen eine große Auswahl an Objekttypen zur Verfügung. Aber: Für eine gegebene Fragestellung kommen idR nur wenige davon konkret in Frage. Betrachten wir, welche Objekttypen für die folgende Fragestellung sinnvoll sein könnten: Wie stehen Fahrzeugalter und Preis miteinander in Beziehung? p &lt;- sample %&gt;% ggplot(aes(x = alter, y = preis)) p + geom_point() p + geom_jitter() # zufälliges &quot;Zittern&quot; um Überlappungen zu reduzieren p + geom_smooth() # Geglättete Linie p + geom_density_2d() # Umrisse einer 2-dimensionalen Dichteschätzung Beachten Sie, dass die geom_[typ] Funktionen teilweise implizite Veränderungen an den Daten vornehmen: bspw. statistische Berechnungen (geom_smooth, geom_density_2d) oder Positionsanpassungen (geom_jitter). Diese standardmäßig verwendeten Verändungen können Sie aber auch manuell verhindern bzw. anpassen, bspw: p + geom_smooth(method = &quot;lm&quot;) # Lineare Regressionsgerade Sie können mithilfe der geom Funktionen auch mehrere Datenschichten übereinander legen. Dabei definiert jeder Objekttyp genau eine Schicht. Je Schicht können auch eigene Daten oder eine eigene Ästhetik-Zuordnung verwendet werden. Beispiel 1: Streudiagramm mit Smooth Line p + geom_point() + geom_smooth() Beipsiel 2: Hervorhebung einer Teilmenge der Daten subset &lt;- sample %&gt;% filter(hersteller == &quot;opel&quot;) p + geom_point(color = &quot;grey&quot;, alpha = 0.2) + geom_point(data = subset, aes(color = hersteller)) Beispiel 3: Labels für interessante Datenpunkte subset &lt;- sample %&gt;% filter(preis==max(preis) | alter==max(alter)) p + geom_point() + ggrepel::geom_label_repel(data = subset, mapping = aes(label = name), min.segment.length = 0.1) Beispiel 4: Streudiagramm mit mehreren Smooth Lines sample %&gt;% ggplot(mapping = aes(x = alter, y = preis, color = fahrzeugtyp)) + geom_point() + geom_smooth(se=FALSE) 2.4 Skalierung Jede Ästhetik hat zunächst eine Standard-Skalierung. Diese können Sie jedoch manuell anpassen 2.4.1 Axen-Skalierung: Wenn Datenpunkte sehr stark in einem kleinen Bereich der Grafik konzentriert sind, kann eine logarithmische Skalierung dabei helfen, diese Datenpunkte visuell zu entzerren. p + geom_point() + geom_smooth() + scale_y_log10() + scale_x_log10() 2.4.2 Farb-Skalierung Je nach Variablentyp eignen sich unterschiedliche Farbskalierungen: Nominal-skalierte Variable sample %&gt;% ggplot(aes(alter, preis, color = fahrzeugtyp)) + geom_point() + scale_color_brewer(type = &quot;qual&quot;, palette = &quot;Set1&quot;) Ordinal-skalierte Variable sample %&gt;% ggplot(aes(alter, preis, color = cut_interval(ps, n = 3))) + geom_point() + scale_color_brewer(type = &quot;seq&quot;, palette = &quot;Reds&quot;) Kardinal-skalierte Variable sample %&gt;% ggplot(aes(alter, preis, color = ps)) + geom_point() + scale_color_gradient(low = &quot;white&quot;, high = &quot;blue&quot;) Es gibt diverse vordefinierte Farbpaletten, siehe z.B. RColorBrewer::display.brewer.all()  alternativ können Farbskalierungen auch selbst definiert werden meine_palette &lt;- c(&quot;#4ecf71&quot;, &quot;#4e5dcf&quot;, &quot;#cf4ecf&quot;, &quot;#cf4e4e&quot;, &quot;#cfa44e&quot;) sample %&gt;% ggplot(aes(alter, preis, color = fahrzeugtyp)) + geom_point() + scale_color_manual(values = meine_palette) 2.5 Facetten Mehrdimensionale Plots sind oft überladen und schwer interpretierbar. Facettenplots sind dann eine hilfreiche Alternative. p &lt;- sample %&gt;% ggplot(aes(alter, preis)) + geom_point() p + facet_wrap(~fahrzeugtyp) p + facet_wrap(~ ps&gt;150) p + facet_grid(fahrzeugtyp ~ ps&gt;100) Hier können sie auch festlegen, dass jede Facette eine eigene Axenskalierung erhält p + facet_wrap(~fahrzeugtyp, scales = &quot;free&quot;) 2.6 Thema und Labels 2.6.1 Labels p + labs(x = &quot;Alter in Jahren&quot;, y = &quot;Preis in &quot;, title = &quot;Gebrauchtwagen&quot;) 2.6.2 Thema Sie können eines der unzähligen vordefinierten Themen verwenden p + theme_classic() p + ggthemes::theme_economist()  oder im Detail ihr eigenes Thema gestalten. p + theme(plot.background = element_rect(fill = &quot;lightgrey&quot;), panel.background = element_rect(fill = &quot;darkgrey&quot;), panel.border = element_rect(size = 2), panel.grid = element_line(linetype = 2), axis.title = element_text(size = 14)) "],["geodaten.html", "3 Geodaten 3.1 Simple Features 3.2 Ästhetiken 3.3 Schichten 3.4 Aggregation 3.5 Koordinatensystem", " 3 Geodaten Visualisierung von Geodaten library(tidyverse) library(sf) theme_set( theme_bw() + theme(panel.background = element_blank(), panel.spacing = unit(0, &quot;lines&quot;), plot.background = element_blank(), legend.justification = c(0, 0), legend.position = c(0, 0), legend.background = element_blank()) ) 3.1 Simple Features df &lt;- read_rds(&quot;data/wdi.rds&quot;) # Einlesen der Daten df &lt;- df %&gt;% filter(jahr==2018) # Einschränkung auf das aktuellste Jahr im Datensatz head(df) ## Simple feature collection with 6 features and 23 fields ## geometry type: MULTIPOLYGON ## dimension: XY ## bbox: xmin: -61.88711 ymin: 16.99717 xmax: 74.89131 ymax: 42.64795 ## CRS: +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 ## # A tibble: 6 x 24 ## iso2c land kontinent subregion jahr bevölkerung bevölkerung_weib~ ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 AD Andorra Europe Southern E~ 2018 77006 NA ## 2 AE United Arab~ Asia Western As~ 2018 9630959 30.6 ## 3 AF Afghanistan Asia Southern A~ 2018 37172386 48.6 ## 4 AG Antigua and~ North Amer~ Caribbean 2018 96286 51.8 ## 5 AL Albania Europe Southern E~ 2018 2866376 49.1 ## 6 AM Armenia Asia Western As~ 2018 2951776 53.0 ## # ... with 17 more variables: bevölkerung_0_14 &lt;dbl&gt;, bevölkerung_65+ &lt;dbl&gt;, ## # bevölkerung_land &lt;dbl&gt;, bevölkerung_stadt &lt;dbl&gt;, ## # bevölkerung_unter$5.50 &lt;dbl&gt;, bruttosozialprodukt &lt;dbl&gt;, fläche &lt;dbl&gt;, ## # lebenserwartung &lt;dbl&gt;, lebenserwartung_mann &lt;dbl&gt;, ## # lebenserwartung_frau &lt;dbl&gt;, kindersterblichkeit &lt;dbl&gt;, geburtenrate &lt;dbl&gt;, ## # co2_emissionen &lt;dbl&gt;, literacy_rate &lt;dbl&gt;, militärausgaben &lt;dbl&gt;, ## # mordrate &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [°]&gt; Es handelt sich nicht um einen gewöhnlichen R Datensatz (data frame), sondern um einen sogenannten Simple Feature Datensatz. Das besondere daran ist die Variable geometry, welche die Koordinaten (Längengrad und Breitengrad) der Ländergrenzen enthält. Analog zum bisherigen Vorgehen, benötigen wir für die Visualisierung einer Weltkarte nur 3 Dinge: (1) den (Simple Feature) Datensatz, (2) eine Ästhetikzuordnung (die Variable geometry wird der Ästhetik geometry zugeordet, und (3) den passenden Objecttyp geom_sf. ggplot(data = df, mapping = aes(geometry = geometry)) + geom_sf() Tatsächlich können wir hier die Ästhetikzuordnung sogar weglassen, die Spezifikation des Datensatzes und geom_sf ist hier sogar ausreichend. ggplot(df) + geom_sf() Was bedeutet der Begriff feature? Ein Feature kann grundsätzlich alles mögliche sein (Land, Fluss, Bushaltestelle), in unserem Fall ist es ein Land. Features können durch unterschiedliche Geometrien repräsentiert werden: eine Bushaltestelle durch einen Punkt, ein Fluss durch eine Linie, ein Land durch ein Polygon oder Multipolygon. Beispielsweise kann das Vereinigte Königreich nur durch einen Multipolygon repräsentiert werden, da es aus zwei Inseln (jeweils Polygone) besteht. uk &lt;- df %&gt;% filter(land == &quot;United Kingdom&quot;) ggplot(uk) + geom_sf() uk[[&quot;geometry&quot;]][[1]][[1]] # Dies sind die Koordinaten von Irland ## [[1]] ## [,1] [,2] ## [1,] -1.065576 50.69023 ## [2,] -1.149365 50.65571 ## [3,] -1.175830 50.61523 ## [4,] -1.196094 50.59922 ## [5,] -1.251465 50.58882 ## [6,] -1.306299 50.58853 ## [7,] -1.515332 50.66978 ## [8,] -1.563428 50.66611 ## [9,] -1.515674 50.70332 ## [10,] -1.385840 50.73354 ## [11,] -1.312793 50.77349 ## [12,] -1.144238 50.73472 ## [13,] -1.065576 50.69023 3.2 Ästhetiken Die wichtigste Ästhetik ist bei Karten in der Regel die Füllfarbe (fill). Wie bisher können sie sie entweder die Füllfarbe entweder auf eine bestimmte Ausprägung (bspw. red) fixieren, oder eine Variable des Datensatzes der Füllfarbe zuordnen (aesthetic mapping). Zu beachten: Die Farbe der Landesgrenzen können über color Ästhetik beeinflusst werden. map &lt;- df %&gt;% ggplot() map + geom_sf(aes(fill=kontinent)) # nominal-skalierte Variable map + geom_sf(aes(fill=lebenserwartung)) # kardinal-skalierte Variable map + geom_sf(aes(fill=lebenserwartung), color = NA) # fest definierte Länderfarbe (hier unsichtbar) 3.3 Schichten Wie bisher können Sie auch hier über zusätzliche geom_[typ] Funktionen weitere Schichten definieren. Dies ist auch hier insbesondere für Hervorhebungen hilfreich. auswahl &lt;- df %&gt;% filter(land %in% c(&quot;Germany&quot;, &quot;Brazil&quot;, &quot;China&quot;, &quot;South Africa&quot;)) map + geom_sf(aes(fill=kontinent)) + geom_sf_label(data = auswahl, aes(label=land)) 3.4 Aggregation In manchen Situationen möchten wir die Daten durch eine Aggregation verdichten, bspw. um die durchschnittliche Lebenserwartung je Kontinent zu berechnen. kontinente &lt;- df %&gt;% group_by(kontinent) %&gt;% summarise(lebenserwartung = mean(lebenserwartung, na.rm=TRUE)) kontinente ## Simple feature collection with 7 features and 2 fields ## geometry type: MULTIPOLYGON ## dimension: XY ## bbox: xmin: -180 ymin: -55.8917 xmax: 180 ymax: 83.59961 ## CRS: +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 ## # A tibble: 7 x 3 ## kontinent lebenserwartung geometry ## &lt;chr&gt; &lt;dbl&gt; &lt;MULTIPOLYGON [°]&gt; ## 1 Africa 63.4 (((-2.938306 5.124495, -2.94834 5.118848, -3.~ ## 2 Asia 74.3 (((122.9489 -10.90928, 122.8559 -10.90967, 12~ ## 3 Europe 79.3 (((55.79736 -21.33936, 55.65615 -21.36904, 55~ ## 4 North America 76.0 (((-78.89834 8.274268, -78.91812 8.231934, -7~ ## 5 Oceania 73.4 (((158.8788 -54.70977, 158.8452 -54.74922, 15~ ## 6 Seven seas (op~ 75.3 (((57.65127 -20.48486, 57.5248 -20.51318, 57.~ ## 7 South America 74.9 (((-67.5752 -55.88965, -67.61143 -55.8917, -6~ Die gute Nachricht: bei der Aggregation wird auch die geometry Variable so aktualisiert, dass diese nun die Umrisse der jeweiligen Kontinente repräsentiert. kontinente %&gt;% ggplot() + geom_sf(aes(fill = lebenserwartung), color = NA) 3.5 Koordinatensystem Bisher haben wir das Thema Koordinatensystem nicht explizit angesprochen. Im Kontext von Karten ist es aber besonders relevant, da unsere 3-dimensionale Erde nicht akurat in 2 Dimensionen dargestellt werden kann. Es stehen uns nun unterschiedlich Projektionen zu Verfügung, die jeweils vorgeben, wo die Längen- und Breitengrade in den zwei Dimensionn verortet werden. Betrachten wir nun folgende Basiskarte: (basiskarte &lt;- df %&gt;% ggplot() + geom_sf(aes(fill = kontinent), color = NA) + scale_fill_brewer(palette = &quot;Set1&quot;)) Die Mercator Projection stellt Formen und Winkel korrekt dar, aber in Richtung der Pole wird die Größe der Länder künstlich aufgebläht. basiskarte + coord_sf(crs = st_crs(&quot;+proj=merc&quot;)) Hingegen werden bei der Lambert Azimuthal Equal Area (LAEA) Projektion die Ländergrößen korrekt dargestellt, wobei aber eine Verzerrung der Formen und Winkel in Kauf genommen wird. Auch der Perspektivwechsel auf einen anderen Mittelpunkt (hier Lhasa, Tibet) kann einen Mehrwert bzgl. der Interpretation schaffen. basiskarte + coord_sf(crs = st_crs(&quot;+proj=laea + lat_0=29.6490404 + lon_0=91.0052352&quot;)) "],["aggregierte-daten.html", "4 Aggregierte Daten 4.1 Sortierung 4.2 Überlappungen 4.3 2 Kategorielle Variablen", " 4 Aggregierte Daten library(tidyverse) theme_set(theme_bw()) df &lt;- read_csv(&quot;data/gebrauchtwagen.csv&quot;) head(df) ## # A tibble: 6 x 13 ## name preis alter kilometer hersteller modell fahrzeugtyp getriebe ps ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 smart_forT~ 5299 7 30000 smart fortwo kleinwagen automat~ 71 ## 2 Renault_Cl~ 1100 16 125000 renault clio kleinwagen manuell 75 ## 3 Audi_A4_Av~ 8199 14 150000 audi a4 kombi automat~ 131 ## 4 Mercedes_B~ 8999 8 150000 mercedes_~ c_kla~ limousine automat~ 136 ## 5 BMW_316_i_~ 3600 13 150000 bmw 3er limousine manuell 116 ## 6 verk._eine~ 2490 11 150000 peugeot 1_rei~ kleinwagen manuell 68 ## # ... with 4 more variables: kraftstoff &lt;chr&gt;, schaden &lt;chr&gt;, plz &lt;dbl&gt;, ## # bundesland &lt;chr&gt; Bis hierhin haben wir hauptsächlich Rohdaten visualisiert. Nun wollen wir hingegen die Rohdaten auf eine höhere Ebene aggregieren und diese Ergebnisse visualisieren, z.B: Anzahl Autos je Fahrzeugtyp (SUV, Cabrio, Kleinwagen, etc) Durchschnittlicher Preis je Hersteller data &lt;- df %&gt;% group_by(fahrzeugtyp) %&gt;% summarise(n = n(), preis = mean(preis)) data ## # A tibble: 5 x 3 ## fahrzeugtyp n preis ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 cabrio 1639 8342. ## 2 kleinwagen 5418 3288. ## 3 kombi 4938 6130. ## 4 limousine 6974 5971. ## 5 suv 1031 11800. Der wichtigste Grafiktyp für diese Art von Daten ist das Balkendiagramm (Bar chart), welches wir über das geometrische Object geom_col erezugen können. data %&gt;% ggplot(aes(x = fahrzeugtyp, y = n)) + geom_col() Eine praktische Alternative zu geom_col ist geom_bar, jedoch noch für den Fall, dass die Anzahl der Beobachtungen dargestellt werden soll. Die Funktion geom_bar kann direkt auf die Rohdaten angewendet werden. Hierbei wird das Zählen der Fälle implizit durch die Funktion ausgeführt und muss nicht explizit per Code berechnet werden. df %&gt;% ggplot(aes(x = fahrzeugtyp)) + geom_bar() 4.1 Sortierung Ein typisches Problem ist, dass eine Text-Variable (character) wie fahrzeugtyp zunächst einmal nur alfabetisch sortiert werden kann. Für eine bessere Interpretierbarkeit ist es jedoch meistens sinnvoll, die Balken sortiert nach ihrer Höhe anzuordnen. Dafür müssen wie die Text-Variable in eine sogenannte Faktor-Variable (factor) umwandenln. Faktoren lassen sich nach unterschiedlichsten Kriterien sortieren, bspw. über die Funktion fct_reorder. data %&gt;% ggplot(aes(x = fct_reorder(fahrzeugtyp, -preis), y = preis)) + geom_col() 4.2 Überlappungen Eine weitere typische Schwierigkeit besteht in sich überlappenden Labels. Dieses Problem tritt insbesondere auf der x-Achse auf. Deshalb lohnt es sich, die Achsenzuordnung zu ändern und so ein horizontales Balkendiagramm zu erzeugen. # Map to y axis data &lt;- df %&gt;% group_by(bundesland) %&gt;% summarise(n = n(), preis = mean(preis)) data %&gt;% ggplot(aes(x = bundesland, y = preis)) + geom_col() data %&gt;% ggplot(aes(y = bundesland, x = preis)) + geom_col() Eine weitere Möglichkeit besteht darin, mehrere kleinere Balken zu einem großen Balken für Sonstige zusammenzufassen. df %&gt;% ggplot(aes(y = fct_lump(bundesland, n= 5))) + geom_bar() 4.3 2 Kategorielle Variablen Wenn wir die aggregierten Statistiken nicht für eine sondern zwei kategorielle Variablen berechnen (bspw. für bundesland und fahrzeugtyp), gibt es mehrere denkbare Darstellungsformen. Eine Heatmap via geom_tile eignet sich insbesondere, wenn die kategoriellen Variablen viele Ausprägungen haben. df %&gt;% count(bundesland, fahrzeugtyp) %&gt;% ggplot() + geom_tile(aes(x = fahrzeugtyp, y = bundesland, fill = n), color = &quot;white&quot;) + geom_text(aes(x = fahrzeugtyp, y = bundesland, label = n), size = 3) + scale_fill_binned(low = &quot;white&quot;, high = &quot;red&quot;) Facetten-Plots können grundsätzlich auch für solche Fälle helfen. Im hier vorliegenden Fall, mit vielen Ausprägungen wird ein Facettenplot aber schnell unübersichtlich. df %&gt;% count(bundesland, fahrzeugtyp) %&gt;% ggplot() + geom_col(aes(y = fahrzeugtyp, x = n)) + facet_wrap(~bundesland, scales = &quot;free&quot;) "]]
